# -*- coding: utf-8 -*-
"""Phone_Price_Prediction.ipynb.

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1nNVQWB6MGHuiQJOJAJXQBDyJG2exGowW

# Phone Price Prediction using Machine Learning

This project predicts the price of mobile phones based on their specifications using Machine Learning regression models.
"""

import pandas as pd

df = pd.read_csv('/content/mobile_phone_price.csv')
df.head()

df.info()

df['Price ($)'] = df['Price ($)'].astype(str)

df['Price ($)'] = (
    df['Price ($)']
    .str.replace('$', '', regex=False)
    .str.replace(',', '', regex=False)
    .str.strip()
)

df['Price ($)'] = df['Price ($)'].astype(int)
df['Price ($)'].dtype

# Remove extra spaces from column names
df.columns = df.columns.str.strip()

# Now clean Storage and RAM
df['Storage'] = df['Storage'].str.replace('GB', '', regex=False).str.strip().astype(int)
df['RAM'] = df['RAM'].str.replace('GB', '', regex=False).str.strip().astype(int)

df[['Storage', 'RAM']].head()

df['Screen Size (inches)'] = df['Screen Size (inches)'].astype(str)

df['Screen Size (inches)'] = (
    df['Screen Size (inches)']
    .str.extract(r'([\d\.]+)')[0]
)

df['Screen Size (inches)'] = df['Screen Size (inches)'].astype(float)

df['Screen Size (inches)'].dtype

df['Camera (MP)'] = df['Camera (MP)'].astype(str)

df['Camera (MP)'] = (
    df['Camera (MP)']
    .str.findall(r'[\d\.]+')
    .apply(lambda x: max([float(i) for i in x]))
)

df['Camera (MP)'].head()

# Select features and target
X = df.drop(['Model', 'Price ($)'], axis=1)
y = df['Price ($)']

# One-hot encode Brand
X = pd.get_dummies(X, columns=['Brand'], drop_first=True)

X.head()

from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

X_train.shape, X_test.shape

from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_absolute_error, r2_score

# Train model
lr = LinearRegression()
lr.fit(X_train, y_train)

# Predictions
y_pred_lr = lr.predict(X_test)

# Evaluation
mae_lr = mean_absolute_error(y_test, y_pred_lr)
r2_lr = r2_score(y_test, y_pred_lr)

mae_lr, r2_lr

print("Linear Regression Results")
print("Mean Absolute Error (MAE):", round(mae_lr, 2))
print("R2 Score:", round(r2_lr, 2))

from sklearn.ensemble import RandomForestRegressor

# Train model
rf = RandomForestRegressor(random_state=42)
rf.fit(X_train, y_train)

# Predictions
y_pred_rf = rf.predict(X_test)

# Evaluation
mae_rf = mean_absolute_error(y_test, y_pred_rf)
r2_rf = r2_score(y_test, y_pred_rf)

mae_rf, r2_rf

print("MODEL COMPARISON")
print("-" * 30)

print("Linear Regression")
print("MAE:", round(mae_lr, 2))
print("R2 Score:", round(r2_lr, 2))

print("\nRandom Forest Regressor")
print("MAE:", round(mae_rf, 2))
print("R2 Score:", round(r2_rf, 2))

# Example input (you can change values later)
sample_phone = {
    'Storage': 128,
    'RAM': 8,
    'Screen Size (inches)': 6.5,
    'Camera (MP)': 50,
    'Battery Capacity (mAh)': 4500,
    'Brand_Apple': 1,
    'Brand_Samsung': 0,
    'Brand_OnePlus': 0,
    'Brand_Xiaomi': 0,
    'Brand_Google': 0
}

# Convert input to DataFrame
input_df = pd.DataFrame([sample_phone])

# Align columns with training data
input_df = input_df.reindex(columns=X.columns, fill_value=0)

# Predict price
predicted_price = rf.predict(input_df)

print("Predicted Phone Price ($):", int(predicted_price[0]))

import joblib

# Save the trained model
joblib.dump(rf, 'random_forest_phone_price_model.pkl')

print("Model saved successfully as 'random_forest_phone_price_model.pkl'")